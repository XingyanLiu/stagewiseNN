

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>stagewiseNN - Building developmental tree from scRNA-seq &mdash; stagewiseNN 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> stagewiseNN
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">stagewiseNN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>stagewiseNN - Building developmental tree from scRNA-seq</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="stagewisenn-building-developmental-tree-from-scrna-seq">
<h1>stagewiseNN - Building developmental tree from scRNA-seq<a class="headerlink" href="#stagewisenn-building-developmental-tree-from-scrna-seq" title="Permalink to this headline">¶</a></h1>
<p><strong>stagewiseNN</strong> is a computational tool for constructing
developmental (lineage) tree from Multi-staged single-cell RNA-seq data.</p>
<p>It starts from building a single-cell graph by connecting each cell to its
k-nearest neighbors in the parent stage, followed by voting-based tree-construction
and adaptive cluster refinement.</p>
<a class="reference internal image-reference" href="_images/stagewisenn.png"><img alt="_images/stagewisenn.png" src="_images/stagewisenn.png" style="height: 250px;" /></a>
<p>The single-cell graph can be further visualized using graph embedding methods, e.g. UMAP, SPRING.</p>
<p>We have used it to build the developmental tree from Amphioxus embryonic cells, across
nine developmental stages (“B”, “G3”, “G4”, “G5”, “G6”, “N0”, “N1”, “N3”, “L0”).
And seven major lineages were recognized.</p>
<a class="reference internal image-reference" href="_images/umap_stage.png"><img alt="_images/umap_stage.png" src="_images/umap_stage.png" style="height: 200px;" /></a>
<a class="reference internal image-reference" href="_images/umap_lineage.png"><img alt="_images/umap_lineage.png" src="_images/umap_lineage.png" style="height: 200px;" /></a>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Requirements:</p>
<ul class="simple">
<li><p>python &gt;= 3.6</p></li>
<li><p>scanpy: <a class="reference external" href="https://scanpy.readthedocs.io/en/stable/installation.html">https://scanpy.readthedocs.io/en/stable/installation.html</a></p></li>
<li><p>scikit-learn: <a class="reference external" href="https://pypi.org/project/scikit-learn/">https://pypi.org/project/scikit-learn/</a></p></li>
</ul>
<p>Install from source code:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/zhanglabtools/stagewiseNN.git
<span class="nb">cd</span> stagewiseNN
python setup.py install
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="tutorial/tutorial_builder_based.html"><span class="doc">Tutorial for using stagewiseNN</span></a> for detailed guide.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">swnn</span>

<span class="c1"># ====== Inputs ======</span>
<span class="c1"># data_matrix = ..</span>
<span class="c1"># stage_labels = ..</span>
<span class="c1"># group_labels = ..</span>
<span class="c1"># stage_order = [f&#39;stage_{i}&#39; for i in range(5)]</span>

<span class="n">builder</span> <span class="o">=</span> <span class="n">swnn</span><span class="o">.</span><span class="n">Builder</span><span class="p">(</span><span class="n">stage_order</span><span class="o">=</span><span class="n">stage_order</span><span class="p">)</span>
<span class="c1"># step1:</span>
<span class="c1"># building (stage-wise) single-cell graph</span>
<span class="n">distmat</span><span class="p">,</span> <span class="n">connect</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_graph</span><span class="p">(</span>
        <span class="n">X</span><span class="o">=</span><span class="n">data_matrix</span><span class="p">,</span> <span class="n">stage_lbs</span><span class="o">=</span><span class="n">stage_labels</span><span class="p">,</span>
    <span class="p">)</span>
<span class="c1"># step2:</span>
<span class="c1"># build developmental tree from single-cell graph</span>
<span class="n">edgedf</span><span class="p">,</span> <span class="n">refined_group_lbs</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_tree</span><span class="p">(</span><span class="n">group_labels</span><span class="p">,</span> <span class="n">stage_labels</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="section" id="contribute">
<h2>Contribute<a class="headerlink" href="#contribute" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Issue Tracker: <a class="reference external" href="https://github.com/XingyanLiu/stagewiseNN/issues">https://github.com/XingyanLiu/stagewiseNN/issues</a></p></li>
<li><p>Source Code:</p>
<ul>
<li><p><a class="reference external" href="https://github.com/zhanglabtools/stagewiseNN">https://github.com/zhanglabtools/stagewiseNN</a></p></li>
<li><p><a class="reference external" href="https://github.com/XingyanLiu/stagewiseNN">https://github.com/XingyanLiu/stagewiseNN</a> (the developmental version)</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h2>
<p>If you are having issues, please let us know.
We have a mailing list located at:</p>
<ul class="simple">
<li><p><a class="reference external" href="mailto:xingyan&#37;&#52;&#48;amss&#46;ac&#46;cn">xingyan<span>&#64;</span>amss<span>&#46;</span>ac<span>&#46;</span>cn</a></p></li>
<li><p><a class="reference external" href="mailto:544568643&#37;&#52;&#48;qq&#46;com">544568643<span>&#64;</span>qq<span>&#46;</span>com</a></p></li>
</ul>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Xingyan Liu.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>